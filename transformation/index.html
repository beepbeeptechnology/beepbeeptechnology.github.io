
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/beepbeep_logo.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.0">
    
    
      
        <title>Transformation - beep beep technology</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bc7e593a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab28b872.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-119865580-5","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-transformation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="beep beep technology" class="md-header-nav__button md-logo" aria-label="beep beep technology">
      
  <img src="../assets/images/beepbeep_logo_white.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            beep beep technology
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Transformation
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="beep beep technology" class="md-nav__button md-logo" aria-label="beep beep technology">
      
  <img src="../assets/images/beepbeep_logo_white.png" alt="logo">

    </a>
    beep beep technology
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../what_we_build/" class="md-nav__link">
      What We Build
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      How We Build It
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="How We Build It" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        How We Build It
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../inbound/" class="md-nav__link">
      Inbound Automation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Transformation
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Transformation
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-profiling" class="md-nav__link">
    Data Profiling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transformation-types" class="md-nav__link">
    Transformation Types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transformation-options" class="md-nav__link">
    Transformation Options
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../outbound/" class="md-nav__link">
      Outbound Automation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../how_we_work/" class="md-nav__link">
      How We Work
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-profiling" class="md-nav__link">
    Data Profiling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transformation-types" class="md-nav__link">
    Transformation Types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transformation-options" class="md-nav__link">
    Transformation Options
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="data-transformation">Data Transformation</h1>
<p>Once your data is loaded into BigQuery, If your inbound data is structured, named and integrated in exactly the way you need to consume it, then that's awesome news!  You can skip most of these steps, however you should still profile the data to ensure that it is free of e.g. duplicate rows or meaningless columns.</p>
<h2 id="data-profiling">Data Profiling</h2>
<p>Before undertaking any data transformation, it is important to profile the incoming data to understand the overall shape (schema, row count) and data types.  Subsequently, investigation of the actual data is advisable to identify if the data contains duplicates, unexpected gaps, data type discontinuities or other characteristics which flag issues to address.</p>
<p>It is also often extremely valuable to understand more nuanced characteristics of the data, from basic statistics (mean, median, mode), to understanding column cardinality, distribution and correlations between columns.</p>
<h2 id="transformation-types">Transformation Types</h2>
<p>We think about data transformations in terms of the following categories, with a range of different objectives and corresponding approaches.</p>
<div class="tabbed-set" data-tabs="1:7"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Cleanse</label><div class="tabbed-content">
<p>Data cleanse activities automate the 'correction' of data, whether that is filtering out duplicate rows, cleaning unwanted characters from strings which can cause downstream errors.  Cleanse activities can use native functionality and/or some generic or case-specific custom functions.</p>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Convert</label><div class="tabbed-content">
<p>To leverage the full capabilities of BigQuery, it is important to ensure that data types are correct, which can be complex depending on the precise format the data is received in.  Date and time formats can pose particular challenges, as well as differing national standards.</p>
</div>
<input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><label for="__tabbed_1_3">Filter</label><div class="tabbed-content">
<p>Common transformation actions are to filter down unwanted or unused columns from the data - improving downstream performance - or to filter down the dataset based on a set combination of column values, to expose a subset of the data to downstream tools.</p>
</div>
<input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><label for="__tabbed_1_4">Aggregate</label><div class="tabbed-content">
<p><a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/aggregate_functions">Aggregate functions</a> then perform some kind of aggregation on the date, grouping the date by a set of dimensions and executing a computation on the corresponding rows.  Example functions are <code>MIN</code>, <code>MAX</code>, <code>SUM</code> or <code>COUNT</code> and normally result in a different (lower) output row count.</p>
</div>
<input id="__tabbed_1_5" name="__tabbed_1" type="radio" /><label for="__tabbed_1_5">Compute</label><div class="tabbed-content">
<p>Computation functions are more complex and are often based on <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/analytic-function-concepts">Analytic Functions</a>, and can achieve complex computational outputs in a single step such as row occurrence counts, or encapsulated in datafunctions to quickly compute e.g. grouped moving averages.</p>
</div>
<input id="__tabbed_1_6" name="__tabbed_1" type="radio" /><label for="__tabbed_1_6">Transform</label><div class="tabbed-content">
<p>Transform functions fundamentally reshape the data, which may be desirable for downstream purposes.  These functions perform actions like pivotting data to transform tidy data into a set of dimensions and columns containing statistics, or unpivotting to achieve the inverse transform.</p>
</div>
<input id="__tabbed_1_7" name="__tabbed_1" type="radio" /><label for="__tabbed_1_7">Integrate</label><div class="tabbed-content">
<p>You will almost certainly want to integrate your data with data from other sources. In SQL, this typically means a type of JOIN, which connects data on a shared set of dimensions.  It is critical to profile pre- and post-join datasets as it is very easy to unwittingly duplicate rows or lose data.</p>
</div>
</div>
<h2 id="transformation-options">Transformation Options</h2>
<p>If your data needs to be cleansed, transformed or integrated with other data, you have some options for how you can do this.</p>
<div class="tabbed-set" data-tabs="2:5"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">SQL</label><div class="tabbed-content">
<p>BigQuery uses Standard SQL (Structured Query Language) for all data manipulation, which is a SQL dialect with some powerful additional capabilities. Simple transformation steps can be written as Standard SQL views, which can then be queried directly from your downstream tools.</p>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">datafunctions</label><div class="tabbed-content">
<p>For more complex and/or repetitive transformation requirements it can be extremely painful and time-consuming to hand-write SQL.  In these instances, we leverage dynamic SQL in BigQuery.  This enables common SQL patterns to be abstracted into re-useable functions (<a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/user-defined-functions">User Defined Functions</a> and <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/scripting">Stored Procedures</a>) which can be chained together to build complex, reuseable transformation patterns.</p>
<p>Underpinning this approach is a library of functions which we build and maintain called datafunctions (<a href="https://datafunctions.github.io">datafunctions.github.io</a>), which are callable directly in BigQuery using the syntax: 
<div class="highlight"><pre><span></span><code>datafunctions.functiontype.function([ARGUMENTS])
</code></pre></div>
This means that you can build complex transformations without ever having to leave the BigQuery UI or learn a completely new platform.</p>
<p>Transformations can be chained together and parameterised, so you can apply the same transformation pattern to a limitless number of datasources with minimal additional effort.</p>
</div>
<input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><label for="__tabbed_2_3">Third Party Platforms</label><div class="tabbed-content">
<p>There are some excellent platforms which bring software engineering best practices to the data engineering workflow, and which might be applicable to your use case.  As external tools there will be some onboarding effort and a learning curve as well as ongoing maintenance effort and potential cost.  However these tools are worth consideration.</p>
<div class="tabbed-set" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">dbt</label><div class="tabbed-content">
<p>Data Build Tool (<a href="https://www.getdbt.com/">dbt</a>) is a open source platform with a hosted paid option, which allows anyone comfortable with SQL to own the data transformation work that happens between loading data into your warehouse and analyzing it.  It is written in Python and includes advanced templating using Jinja, version-controlled automated documentation, testing, package management and a huge amount of additional functionality.</p>
</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">DataForm</label><div class="tabbed-content">
<p><a href="https://dataform.co/">DataForm</a> is another highly regarded modern analytics engineering platform, with a very similar objective to dbt, and a focus on collaboration between data teams and a unified, robust approach to data modelling.  Whereas dbt is Python-centric, DataForm leverages JavaScript, so your choice of tool might be influenced by team capabilities in these languages.</p>
</div>
</div>
</div>
<input id="__tabbed_2_4" name="__tabbed_2" type="radio" /><label for="__tabbed_2_4">ETL Tools</label><div class="tabbed-content">
<p>Some ETL tools enable you to do data transformations to a varying degree before you load the data into BigQuery.  However our preferred approach is to separate logical activities and use ETL tools to load the data in the original form (with maybe an additional load timestamp or other load metadata), transform in BigQuery, and then give your external tools access to the transformed dataset.  This gives the additional benefit of making it simpler to swap out pipeline components with minimal additional effort, avoiding being 'locked in' to specific providers.</p>
</div>
<input id="__tabbed_2_5" name="__tabbed_2" type="radio" /><label for="__tabbed_2_5">Downstream Tools</label><div class="tabbed-content">
<p>You can also undertake transformations within your downstream tools, which might seem easier at the time, but which can cause longer term issues.  Building complex logic into e.g. a spreadsheet or your Business Intelligence tool can be very difficult to quality assure, replicate or scale.  Building all of your transformation logic into BigQuery enables you to avoid these potential pitfalls, as well as eliminating 'lock in' to a specific tool, and ensuring that every tool you use to access your data has the same, single source of truth.</p>
</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../inbound/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Inbound Automation
              </div>
            </div>
          </a>
        
        
          <a href="../outbound/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Outbound Automation
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="mailto:info@beepbeep.technology" target="_blank" rel="noopener" title="" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.6a3d08fc.min.js"></script>
      <script src="../assets/javascripts/bundle.71201edf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>